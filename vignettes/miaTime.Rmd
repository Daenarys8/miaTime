---
title: "miaTime: Microbiome Time Series Analysis"
date: "`r Sys.Date()`"
author:
- name: Leo Lahti
  email: leo.lahti@iki.fi
- name: Yagmur Simsek
  email: yagmur.simsek@hsrw.org
package: 
    miaTime
output: 
    BiocStyle::html_document:
        fig_height: 7
        fig_width: 10
        toc: yes
        toc_depth: 2
        number_sections: true
vignette: >
    %\VignetteIndexEntry{miaTime}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
---

```{r, echo=FALSE}
knitr::opts_chunk$set(cache = FALSE,
                        fig.width = 9,
                        message = FALSE,
                        warning = FALSE)
```

# Introduction

`miaTime` implements tools for microbiome time series manipulation based on the
`SummarizedExperiment` [@SE] 

# Installation

To install `miaTime`, install `devtools` first, if it is not installed.
Afterwards use the `install_github` function from `devtools`.

```{r, eval=FALSE}
library(devtools)
devtools::install_github("microbiome/miaTime")
```

# Load *miaTime*

```{r load-packages, message=FALSE, warning=FALSE}
library("miaTime")
```

# Functions

`timeToDate` converts numeric time points to characters that contain time. 
The dataset `hitchip1006` stored in `miaTime` can be used as an example.
```{r}
library(miaTime)
data(hitchip1006)
hitchipDate <- timeToDate(hitchip1006, "time", unit = "mins")

colData(hitchip1006)$time[c(1141:1151)]
```
```{r}
hitchipDate[c(1141:1151)]

```
This can be added to `SummarizedExperiment` object that is used to store 
`hitchip1006`. 
```{r}
colData(hitchip1006)$clock <- hitchipDate
colData(hitchip1006)
```

Function `timeDifferences` helps to find the consecutive time difference and 
the distance from the specified time point. It also converts the given time
character is converted to numeric time.

```{r}
hitchipTime <- timeDifferences(hitchipDate, baseline = 1, units = "mins")

colData(hitchip1006)$time_diff <- hitchipTime$Consecutive
colData(hitchip1006)$base_diff <- hitchipTime$Baseline

colData(hitchip1006)
```

`addOrderSequence` adds a new field that gives the rank of the chosen field.
```{r}
data(GlobalPatterns, package="mia")
se <- GlobalPatterns
se1 <- addOrderSequence(se,field = "SampleType",
            rank_field_name = "SampleType_rank",
            na.last = TRUE, ties.method = "first")
```

The functions in `miaTime` are applied on `SummarizedExperiment`
object or `TreeSummarizedExperiment` object. It returns same object 
class as given.

# Session info

```{r}
sessionInfo()
```
